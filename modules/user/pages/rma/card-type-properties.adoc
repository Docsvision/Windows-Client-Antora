= Свойства типа карточки

В ветках системной папки _Карточки_ (в стандартной поставке -- _Базовые карточки_, _{ad}_ и _{wf}_) представлены все имеющиеся типы карточек, включая и справочники, которые по своей сути также являются карточками.

Контекстное меню каждого типа карточки, расположенного в левой панели РМА, содержит только один пункт: _Свойства_. При выборе пункта открывается диалоговое окно _Свойства типа карточки_ с описанием свойств, присущих всем карточкам данного типа.

.Чтобы изменить параметры настройки типа карточки, выполните следующие действия:
. Выделите тип карточки, свойства которой необходимо изменить, и откройте диалоговое окно _Свойства типа карточки_ одним из следующих способов:
+
* Нажмите правой кнопкой мыши по нужной папке и выберите в появившемся контекстном меню команду _Свойства_.
* Выберите в меню последовательно команды menu:Файл[Папка > Свойства].
+
Будет открыто диалоговое окно _Свойства типа карточки_, включающее вкладки _Общие_, _Преобразования_, _Шаблоны_ и _Безопасность_. На вкладке _Общие_ отображается наименование типа карточек (в данном случае -- _Документ_), не подлежащее изменению.
+
.Вкладка "Общие" свойств типа карточки
image::card-properties-general-type.png[Вкладка "Общие" свойств типа карточки]
+
. Перейдите на вкладку _Общие_, чтобы запретить или разрешить пользователям создание в системе и удаление из неё карточек данного типа:
+
* Установите флаг `*Пользователь может создавать карточки*`, чтобы разрешить пользователям создавать карточки данного типа.
* Установите флаг `*Пользователь может удалять карточки*`, чтобы разрешить пользователям удалять карточки данного типа.
+
[NOTE]
====
При снятом флаге `*Пользователь может удалять карточки*` пользователи не смогут удалять из системы карточки данного типа, но смогут удалять содержащие их папки.
====
+
. Перейдите на вкладку _Преобразование_, чтобы создать новое, изменить или удалить уже имеющееся преобразование карточек.
+
Поле этой вкладки содержит список преобразований с указанием их типа. Справа от поля расположены кнопки, позволяющие <<export,экспортировать>> преобразование в файл формата `.xslt`.
+
.Вкладка "Преобразование" окна свойств типа карточки
image::transformation-tab.png[Вкладка "Преобразование" окна свойств типа карточки]
+
. Перейдите на вкладку _Шаблоны_, чтобы определить папку, в которой будут размещаться все созданные по шаблону экземпляры карточек рассматриваемого типа:
+
* Укажите в поле _По умолчанию создавать карточки в данной папке_ нужную папку.
+
Папка выбирается в диалоговом окне _Выбор папки_, раскрывающемся при нажатии кнопки image:admin:buttons/three-dots.png[Три точки]. Очистить поле можно нажав кнопку image:buttons/x-black-rma.png[Чёрный крестик].
* При необходимости установите флаг `*Запрашивать папку только при нажатой клавише Shift*`. Установка флага приводит к тому, что экземпляр карточки будет создаваться в обозначенной папке при двойном щелчке мышью по карточке шаблона. Система будет запрашивать подтверждение выбора папки только в случае нажатой клавиши kbd:[Shift].
+
.Вкладка "Шаблоны" свойств типа карточек
image::card-properties-template-type-rma.png[Вкладка "Шаблоны" свойств типа карточек]
+
[WARNING]
====
Если на вкладках _Шаблоны_ в окне свойств типа карточки и в окне свойств шаблона карточки указаны разные папки для создания экземпляров карточки, будут применены настройки конкретного шаблона.
====
+
. Перейдите на вкладку _Доступ_ и xref:security.adoc[определите уровень] доступа пользователей по мандатной модели безопасности ко всем карточкам данного типа.
+
Вкладка отображается только у членов группы {dv-sec-admins-serv}.
+
.Вкладка "Доступ" свойств типа карточек
image::card-properties-access-type-rma.png[Вкладка "Доступ" свойств типа карточек]
+
. Перейдите на вкладку _Безопасность_ и xref:security.adoc[настройте права доступа] пользователей ко всем карточкам данного типа.

== Управление преобразованиями

Настроить преобразования карточки можно на вкладке _Преобразование_ в окне свойств типа карточки с помощью кнопок справа от поля с названием и типом преобразований.

[#create]
=== Создание преобразования

.Чтобы создать преобразование, выполните следующие действия:
. Откройте окно свойств типа карточки и перейдите на вкладку _Преобразование_.
. Выделите в списке поля этого окна преобразование, свойства которого требуется изменить.
. Нажмите кнопку *Создать*, чтобы открыть окно _Свойства преобразования_.
+
.Свойства преобразования карточки
image::card-type-properties-transformation.png[Свойства преобразования карточки]
+
. В полях окна _Свойства преобразования_ определите параметры преобразования:
+
* В поле _Название_ введите название преобразования.
+
Если окно открывается, чтобы добавить в список новое пользовательское преобразование, преобразованию будет присвоено название по умолчанию -- `Новое преобразование`.
+
* В поле _Тип преобразования_ выберите один из трёх возможных типов преобразований: *_XSLT_*, *_InfoPath_* и *_Пользовательское_*.
* В поле _Тип содержимого_ указывается тип данных, к которым может быть применено преобразование выбранного типа.
+
Набор возможных преобразований описан в таблице ниже.
+
.Типы преобразований и соответствующие им типы содержимого
[cols=",",options="header"]
|===
|Тип преобразования |Тип содержимого

|*_XSLT_* -- в результате преобразование будет применено XML-данным карточки при помощи стандартного XML-парсера.

XSLT-преобразование выполняется платформой автоматически
|XML

|*_InfoPath_* -- форма InfoPath, которая активируется для XML карточки.

Выполнение InfoPath-преобразования и отображение формы выполняет Microsoft Infopath
|Бинарные данные

|*_Custom_* -- пользовательский тип преобразования, определяемый разработчиком карточки.

В качестве преобразования может быть указан любой текст или поток байтов. Вызов и применение такого преобразования выполняется разработчиком карточки в её коде.
|Текст XML, Бинарные данные
|===
+
. Выберите в поле _Данные преобразования_ файл, содержащий заранее подготовленное преобразование.
. Установите флаг `*Преобразование по умолчанию*`, если предполагается сделать новый шаблон печати основным.
+
Основной шаблон будет выбран системой по умолчанию при вызове функции печати. В общем списке название преобразования по умолчанию выделяется жирным шрифтом.

[#edit]
=== Изменение свойств преобразования

.Чтобы изменить свойства преобразования, выполните следующие действия:
. Откройте окно свойств типа карточки и перейдите на вкладку _Преобразование_.
. Выделите в списке поля этого окна преобразование, свойства которого требуется изменить.
. Нажмите кнопку *Свойства*.
. В появившемся окне измените свойства преобразования так, как это описано в пункте _Создание преобразования_ <<create,выше>>.

[#delete]
=== Удаление преобразования

.Чтобы удалить преобразование из списка преобразований для данного типа:
. Откройте окно свойств типа карточки и перейдите на вкладку _Преобразование_.
. Выделите в списке поля этого окна преобразование, которое требуется удалить.
. Нажмите кнопку *Удалить*.
+
Преобразование будет удалено из списка без дополнительного предупреждения.

[#export]
=== Экспорт преобразования

Экспортировать преобразование может потребоваться, например, чтобы в последующем изменить его и затем добавить в список пользовательского преобразования.

.Чтобы скопировать преобразования из системы {dv} в XSLT-файл:
. Откройте окно свойств типа карточки и перейдите на вкладку _Преобразование_.
. В окне выберите из списка окна преобразование, предназначенное для экспорта.
. Нажмите кнопку *Экспорт*, чтобы открыть диалоговое окно _Сохранение_.
. В окне _Сохранение_ выберите файл для экспорта и нажмите кнопку *Сохранить*.
