= Экспорт, импорт, печать и отправка карточек по почте

Печать данных карточки, сохранение их в файле формата `.xml`, отправка по электронной почте выполняются с панели инструментов диалогового окна _Экспорт и печать_. Открыть диалоговое окно _Экспорт и печать_ можно командой из контекстного меню.

.Окно "Экспорт и печать"
image::card-export-print-rma.png[Окно "Экспорт и печать"]

.Все перечисленные ниже функции данного окна можно применить:
* К шаблону печати.
* К файлу формата XML, соответствующему данному бизнес-процессу или карточке.
* К файлу формата XML, соответствующему данному бизнес-процессу или карточке и связанным карточкам.
* К URL карточки.

[NOTE]
====
Если карточка помещена в архив, из перечисленных опций будет доступно только помещение URL-ссылки на карточку в буфер обмена.
====

Выбрать формат данных можно из раскрывающегося списка поля _Формат_.

[#buttons]
.На панели инструментов окна "Экспорт и печать" расположены следующие кнопки:
* *Сохранить* image:buttons/save-small.png[Дискета] -- позволяет сохранить данные карточки в выбранном формате.
* *Скопировать в буфер обмена* image:buttons/copy-paste-rma.png[Планшет] -- позволяет скопировать данные карточки в буфер для последующей вставки в какой-либо другой файл.
* *Печать* image:buttons/printer-small-rma.png[Принтер] -- открывает диалоговое окно стандартных настроек печати, позволяющее:
** Выбрать принтер для печати.
** Указать страницы, предназначенные для печати.
** Указать число копий.
** Отложить печать, установив флаг `*Печать в файл*`.
+
При выборе этого флага по указанному адресу будет сформирован файл формата `.prn`. Этот файл может быть распечатан в любое время, как только принтер станет доступен.
+
** Настроить параметры печати в окне *Печать*, нажав кнопку *Настройка*. Дополнительные параметры печати включают: количество страниц на одном листе, формат, ориентация и источник бумаги.
+
.Окно настройки параметров печати
image::printing-rma.png[Окно настройки параметров печати]
+
* _Предварительный просмотр_ image:buttons/printer-magn-glass.png[Принтер с лупой] -- открывает окно для отображения документа в финальном виде, включая колонтитулы и разбиение на страницы.
+
.Предварительный просмотр в окне печати
image::printing-preview-rma.png[Предварительный просмотр в окне печати]
+
.На панели инструментов этого окна расположены кнопки:
** *Печать* image:buttons/printer-small-preview-rma.png[Принтер] -- вызывает диалоговое окно _Печать_ стандартных настроек печати, описанное в предыдущем пункте.
** Кнопки image:buttons/orintation-preview-rma.png[Книжная -- альбомная ориентация] для выбора ориентации страницы.
** Кнопка параметров страницы image:buttons/page-parameters-preview-rma.png[Шестерёнка] -- позволяющая выбрать в диалоговом окне _Параметры страницы_ размер, ориентацию и источник бумаги, задать отступы от краев бумаги, а также указать надписи, выводимые в колонтитулах документа.
** Кнопка image:buttons/colontitle.png[Колонтитулы на странице], включающая и отключающая отображение колонтитулов.
** Кнопки image:buttons/width-whole.png[По ширине страницы или по высоте] для просмотра страницы по высоте или по ширине окна.
** Раскрывающийся список image:buttons/many-at-once.png[Отображение 1 страницы] для отображения в окне предпросмотра страницы или нескольких (до 12).
** Выпадающий список image:buttons/scale-printing-rma.png[Сжать по размеру] --для изменения масштаба просмотра.
** Кнопки image:buttons/paged-printing-rma.png[Стрелки влево и вправо] постраничного просмотра документа.
** Кнопки image:buttons/quick-first-last-printing-rma.png[Треугольники с полосой на вершине] быстрого перемещения на первую и последнюю страницы.
** Кнопка image:buttons/info-preview-printing-rma.png[Знак вопроса] -- справка по печати. Открывает страницу справки о печати из Internet Explorer на сайте Microsoft.
+
* Кнопка image:buttons/page-parameters-printing-rma.png[Лист с шестерёнокй] -- открывает окно всех параметров страницы.
* {empty}
+
--
include::partial$excerpts.adoc[tags=send-mail]
--
+
* *Создать ярлык для сотрудника* image:buttons/create-shortcut-printing-rma.png[Ярлык папки] -- открывает окно для выбора сотрудника, в личной папке которого будет создан ярлык на карточку.

[#xml-export]
== Экспорт данных карточки в файл формата .xml

При экспорте данных карточки в файл формата `.xml` параметры карточки сохраняются в файловой системе компьютера пользователя. Приложенные к карточке файлы, как и данные о них, экспорту не подлежат.

:files: экспортируются
include::partial$excerpts.adoc[tags=external]

.Чтобы экспортировать данные какой-либо карточки в файл .xml:
. В РМА выделите строку карточки, данные которой предназначены для экспорта и вызовите контекстное меню.
. В контекстном меню выберите опцию _Экспорт и печать_.
+
.Окно "Экспорт и печать"
image::card-export-print-rma.png[Окно "Экспорт и печать"]
+
. В окне _Экспорт и печать_ из раскрывающегося списка поля _Формат_ выберите пункт:
* *_XML карточки_*, если предполагается экспортировать только данные открытой карточки.
* *_XML карточки со связанными карточками_*, если предполагается экспортировать данные открытой карточки и связанных с ней карточек.
+
. Нажмите на панели инструментов кнопку *Сохранить* image:buttons/save-small.png[Дискета].
. В окне *_*Сохранить как_** в поле _Название файла_ введите название файла и нажмите кнопку *Сохранить*.
+
Данные карточки будут экспортированы в указанный файл формата `.xml`.

[#xml-import]
== Импорт данных карточки из файла формата .xml

При импорте данных карточки из файла формата `.xml` в систему {dv} переносятся параметры карточки (или нескольких карточек), ранее сохранённой в файловой системе компьютера пользователя.

:files: импортируются
include::partial$excerpts.adoc[tags=external]

.Чтобы импортировать данные из файла формата .xml, выполните следующие действия:
. Откройте РМА.
. Выделите в списке папку, в которой будет создана карточка с импортированными данными.
. Выберите из контекстного меню команды menu:Создать[Импортировать карточки...].
. В окне _Открыть_ выберите файл (файлы), данные которого предполагается импортировать и нажмите кнопку *Открыть*.
+
Выбранный файл формата `.xml` помимо данных исходной карточки может содержать данные присоединенных к ней карточек. Если импорт проводит пользователь, включённый в группу *{dv-admins-serv}* на сервере {dv} или группу _{dv-admins-dir}_ в справочнике сотрудников, то в {dv} будут импортированы все данные, содержащиеся в файле. При импорте, осуществляемом рядовым пользователем, будут импортированы только данные исходной карточки.
+
[NOTE]
====
Если идентификатор уже имеющейся в базе карточки совпадет с идентификатором импортируемой карточки, её данные будут заменены на новые, полученные в результате импорта.

Однако, если при выборе команды _Импортировать карточки..._ и последующем выборе файла для импорта удерживать нажатой клавишу kbd:[Shift], то импортируемая карточка будет создана с другим идентификатором.
====

Данные файла `.xml` будут импортированы в {dv}.

[#print-template]
== Печать данных карточки с использованием шаблонов печати

В некоторых случаях может оказаться, что удобнее работать с бумажной формой карточки.

.Чтобы распечатать данные карточки в соответствии с существующим шаблоном печати:
. Откройте РМА и выделите строку карточки, данные которой предназначены для печати и вызовите контекстное меню.
. Выберите из контекстного меню опцию _Экспорт и печать_.
+
.Окно "Экспорт и печать"
image::card-export-print-rma.png[Окно "Экспорт и печать"]
+
. В открывшемся окне из раскрывающегося списка _Формат_ выберите пункт *_Шаблон печати для вида документа_*.
. Выполните настройку печати с помощью <<buttons,кнопок окна>> _Экспорт и печать_.

[#send-mail]
== Отправка данных карточки по электронной почте

.Чтобы отправить данные карточки по электронной почте, выполните следующие действия:
. В РМА выделите строку карточки для экспорта.
. В контекстном меню выберите опцию _Экспорт и печать_.
+
.Окно "Экспорт и печать"
image::card-export-print-rma.png[Окно "Экспорт и печать"]
+
. Нажмите кнопку *Отправить почтой* image:buttons/send-by-mail-printing-rma.png[Письмо с конвертом] на панели инструментов окна.
+
Будет открыто окно почтовой программы в режиме создания нового письма. Это письмо будет содержать ссылку на карточку, данные которой отправляются по почте.
+
[NOTE]
====
include::partial$excerpts.adoc[tags=send-mail]
====
